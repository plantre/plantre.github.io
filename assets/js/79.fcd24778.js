(window.webpackJsonp=window.webpackJsonp||[]).push([[79],{436:function(t,s,a){"use strict";a.r(s);var n=a(7),r=Object(n.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("p",[t._v("åœ¨ Redis 3ä¸»3ä»é›†ç¾¤ä¸­å®ç°åˆ†å¸ƒå¼é”æ—¶ï¼Œéœ€ç»“åˆ Redis Cluster çš„ç‰¹æ€§å’Œåˆ†å¸ƒå¼é”çš„æ ¸å¿ƒåŸåˆ™ï¼ˆäº’æ–¥æ€§ã€å®¹é”™æ€§ã€é¿å…æ­»é”ï¼‰è®¾è®¡ã€‚ä»¥ä¸‹æ˜¯å…·ä½“æ–¹æ¡ˆåŠæ³¨æ„äº‹é¡¹ï¼š")]),t._v(" "),s("hr"),t._v(" "),s("h3",{attrs:{id:"ğŸ”’-ä¸€ã€åŸºç¡€æ–¹æ¡ˆ-å•èŠ‚ç‚¹é”-é€‚ç”¨äºä½è¦æ±‚åœºæ™¯"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ”’-ä¸€ã€åŸºç¡€æ–¹æ¡ˆ-å•èŠ‚ç‚¹é”-é€‚ç”¨äºä½è¦æ±‚åœºæ™¯"}},[t._v("#")]),t._v(" ğŸ”’ ä¸€ã€åŸºç¡€æ–¹æ¡ˆï¼šå•èŠ‚ç‚¹é”ï¼ˆé€‚ç”¨äºä½è¦æ±‚åœºæ™¯ï¼‰")]),t._v(" "),s("h4",{attrs:{id:"å®ç°æ­¥éª¤"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#å®ç°æ­¥éª¤"}},[t._v("#")]),t._v(" "),s("strong",[t._v("å®ç°æ­¥éª¤")])]),t._v(" "),s("ol",[s("li",[s("p",[s("strong",[t._v("åŠ é”å‘½ä»¤")]),s("br"),t._v("\nä½¿ç”¨ "),s("code",[t._v("SET key unique_value NX PX 30000")]),t._v(" å‘½ä»¤ï¼š")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("NX")]),t._v("ï¼šä»…å½“ Key ä¸å­˜åœ¨æ—¶è®¾ç½®ï¼Œä¿è¯äº’æ–¥æ€§ã€‚")]),t._v(" "),s("li",[s("code",[t._v("PX 30000")]),t._v("ï¼šè®¾ç½® 30 ç§’è¶…æ—¶ï¼Œé¿å…æ­»é”ã€‚")]),t._v(" "),s("li",[s("code",[t._v("unique_value")]),t._v("ï¼šä½¿ç”¨ UUID æˆ–çº¿ç¨‹ ID æ ‡è¯†é”æŒæœ‰è€…ã€‚")])])]),t._v(" "),s("li",[s("p",[s("strong",[t._v("é‡Šæ”¾é”")]),s("br"),t._v("\né€šè¿‡ Lua è„šæœ¬åŸå­åŒ–é‡Šæ”¾ï¼ˆé¿å…è¯¯åˆ å…¶ä»–å®¢æˆ·ç«¯çš„é”ï¼‰ï¼š")]),t._v(" "),s("div",{staticClass:"language-lua line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-lua"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" redis"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("call")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"GET"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" KEYS"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" ARGV"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" \n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" redis"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("call")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"DEL"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" KEYS"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" \n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" \n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" \n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br")])])])]),t._v(" "),s("h4",{attrs:{id:"é£é™©"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#é£é™©"}},[t._v("#")]),t._v(" "),s("strong",[t._v("é£é™©")])]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("ä¸»ä»åˆ‡æ¢å¯¼è‡´é”ä¸¢å¤±")]),s("br"),t._v("\nä¸»èŠ‚ç‚¹åŠ é”åæ•°æ®æœªåŒæ­¥åˆ°ä»èŠ‚ç‚¹æ—¶ï¼Œè‹¥ä¸»èŠ‚ç‚¹å®•æœºï¼Œä»èŠ‚ç‚¹å‡çº§åæ— é”æ•°æ®ï¼Œå¯¼è‡´å…¶ä»–å®¢æˆ·ç«¯å¯é‡å¤åŠ é”ã€‚")]),t._v(" "),s("li",[s("strong",[t._v("é”ç»­æœŸé—®é¢˜")]),s("br"),t._v("\nä¸šåŠ¡æ‰§è¡Œè¶…æ—¶éœ€æ‰‹åŠ¨ç»­æœŸï¼ˆWatch Dog æœºåˆ¶ï¼‰ï¼Œå¦åˆ™é”è‡ªåŠ¨å¤±æ•ˆã€‚")])]),t._v(" "),s("blockquote",[s("p",[s("strong",[t._v("é€‚ç”¨åœºæ™¯")]),t._v("ï¼šå¯¹é”å¯é æ€§è¦æ±‚ä¸é«˜çš„ä¸šåŠ¡ï¼ˆå¦‚ç¼“å­˜æ›´æ–°ï¼‰ã€‚")])]),t._v(" "),s("hr"),t._v(" "),s("h3",{attrs:{id:"âš™ï¸-äºŒã€é«˜å¯ç”¨æ–¹æ¡ˆ-redlock-ç®—æ³•-å®˜æ–¹æ¨è"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#âš™ï¸-äºŒã€é«˜å¯ç”¨æ–¹æ¡ˆ-redlock-ç®—æ³•-å®˜æ–¹æ¨è"}},[t._v("#")]),t._v(" âš™ï¸ äºŒã€é«˜å¯ç”¨æ–¹æ¡ˆï¼šRedLock ç®—æ³•ï¼ˆå®˜æ–¹æ¨èï¼‰")]),t._v(" "),s("p",[t._v("é’ˆå¯¹ä¸»ä»å®¹é”™é—®é¢˜ï¼ŒRedis ä½œè€…æå‡º "),s("strong",[t._v("RedLock ç®—æ³•")]),t._v("ï¼Œé€šè¿‡å¤šèŠ‚ç‚¹æŠ•ç¥¨æœºåˆ¶æå‡å¯é æ€§ã€‚")]),t._v(" "),s("h4",{attrs:{id:"å®ç°æµç¨‹"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#å®ç°æµç¨‹"}},[t._v("#")]),t._v(" "),s("strong",[t._v("å®ç°æµç¨‹")])]),t._v(" "),s("ol",[s("li",[s("p",[s("strong",[t._v("éƒ¨ç½²ç‹¬ç«‹èŠ‚ç‚¹")]),s("br"),t._v("\n3ä¸»3ä»é›†ç¾¤ä¸­ï¼Œå°† "),s("strong",[t._v("3ä¸ªä¸»èŠ‚ç‚¹è§†ä¸ºç‹¬ç«‹èŠ‚ç‚¹")]),t._v("ï¼ˆä»èŠ‚ç‚¹ä»…ç”¨äºå¤‡ä»½ï¼Œä¸å‚ä¸é”å†³ç­–ï¼‰ã€‚")])]),t._v(" "),s("li",[s("p",[s("strong",[t._v("åŠ é”æ­¥éª¤")]),t._v("ï¼š")]),t._v(" "),s("ol",[s("li",[t._v("ç”Ÿæˆå…¨å±€å”¯ä¸€ IDï¼ˆå¦‚ UUIDï¼‰ä½œä¸ºé”æ ‡è¯†ã€‚")]),t._v(" "),s("li",[t._v("å‘æ‰€æœ‰ä¸»èŠ‚ç‚¹é¡ºåºå‘é€åŠ é”å‘½ä»¤ï¼ˆ"),s("code",[t._v("SET key uuid NX PX TTL")]),t._v("ï¼‰ï¼Œå¹¶è®°å½•æ“ä½œå¼€å§‹æ—¶é—´ "),s("code",[t._v("T1")]),t._v("ã€‚")]),t._v(" "),s("li",[t._v("è®¡ç®—æ€»è€—æ—¶ "),s("code",[t._v("T_total = T2 - T1")]),t._v("ï¼ˆ"),s("code",[t._v("T2")]),t._v(" ä¸ºæ”¶åˆ°æœ€åä¸€ä¸ªå“åº”çš„æ—¶é—´ï¼‰ï¼Œéœ€æ»¡è¶³ï¼š\n"),s("ul",[s("li",[s("code",[t._v("T_total < é”è¶…æ—¶æ—¶é—´")]),t._v("ï¼ˆé˜²æ­¢é”è‡ªåŠ¨å¤±æ•ˆï¼‰ã€‚")]),t._v(" "),s("li",[s("strong",[t._v("æˆåŠŸèŠ‚ç‚¹æ•° â‰¥ N/2 + 1")]),t._v("ï¼ˆ3èŠ‚ç‚¹æ—¶éœ€è‡³å°‘2ä¸ªæˆåŠŸï¼‰ã€‚")])])]),t._v(" "),s("li",[t._v("è‹¥æˆåŠŸï¼Œé”å®é™…æœ‰æ•ˆæ—¶é—´ = "),s("code",[t._v("TTL - T_total - æ—¶é’Ÿæ¼‚ç§»è¡¥å¿")]),t._v("ã€‚")])])]),t._v(" "),s("li",[s("p",[s("strong",[t._v("é‡Šæ”¾é”")]),t._v("ï¼š"),s("br"),t._v("\nå‘æ‰€æœ‰ä¸»èŠ‚ç‚¹å‘é€ Lua è„šæœ¬é‡Šæ”¾é”ï¼ˆå³ä½¿æœªæˆåŠŸåŠ é”çš„èŠ‚ç‚¹ä¹Ÿéœ€å°è¯•ï¼‰ã€‚")])])]),t._v(" "),s("h4",{attrs:{id:"å‚æ•°é…ç½®"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#å‚æ•°é…ç½®"}},[t._v("#")]),t._v(" "),s("strong",[t._v("å‚æ•°é…ç½®")])]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[s("strong",[t._v("å‚æ•°")])]),t._v(" "),s("th",[s("strong",[t._v("å»ºè®®å€¼")])]),t._v(" "),s("th",[s("strong",[t._v("è¯´æ˜")])])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("é”è¶…æ—¶æ—¶é—´ï¼ˆTTLï¼‰")]),t._v(" "),s("td",[t._v("10s-30s")]),t._v(" "),s("td",[t._v("éœ€å¤§äºä¸šåŠ¡æœ€å¤§è€—æ—¶")])]),t._v(" "),s("tr",[s("td",[t._v("é‡è¯•é—´éš”")]),t._v(" "),s("td",[t._v("100-300ms")]),t._v(" "),s("td",[t._v("é¿å…é¢‘ç¹é‡è¯•å‹å®èŠ‚ç‚¹")])]),t._v(" "),s("tr",[s("td",[t._v("ç»­æœŸé—´éš”")]),t._v(" "),s("td",[t._v("TTL/3ï¼ˆå¦‚10sï¼‰")]),t._v(" "),s("td",[t._v("Watch Dog ç»­æœŸé¢‘ç‡")])])])]),t._v(" "),s("h4",{attrs:{id:"ç”Ÿäº§çº§å·¥å…·"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ç”Ÿäº§çº§å·¥å…·"}},[t._v("#")]),t._v(" "),s("strong",[t._v("ç”Ÿäº§çº§å·¥å…·")])]),t._v(" "),s("p",[t._v("æ¨èä½¿ç”¨ "),s("strong",[t._v("Redisson åº“")]),t._v("ï¼ˆæ”¯æŒè‡ªåŠ¨ç»­æœŸã€å¯é‡å…¥é”ã€RedLock å°è£…ï¼‰ï¼š")]),t._v(" "),s("div",{staticClass:"language-java line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RedissonClient")]),t._v(" client "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Redisson")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("create")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RLock")]),t._v(" lock1 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" client"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getLock")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"lock1"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RLock")]),t._v(" lock2 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" client"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getLock")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"lock2"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RLock")]),t._v(" lock3 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" client"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getLock")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"lock3"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RedissonRedLock")]),t._v(" redLock "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RedissonRedLock")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("lock1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" lock2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" lock3"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("try")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("redLock"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("tryLock")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("30")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("TimeUnit")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("SECONDS")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å°è¯•5ç§’ï¼Œé”æœ‰æ•ˆæœŸ30ç§’")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æ‰§è¡Œä¸šåŠ¡é€»è¾‘")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("finally")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    redLock"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("unlock")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br")])]),s("hr"),t._v(" "),s("h3",{attrs:{id:"âš ï¸-ä¸‰ã€å…³é”®æ³¨æ„äº‹é¡¹"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#âš ï¸-ä¸‰ã€å…³é”®æ³¨æ„äº‹é¡¹"}},[t._v("#")]),t._v(" âš ï¸ ä¸‰ã€å…³é”®æ³¨æ„äº‹é¡¹")]),t._v(" "),s("ol",[s("li",[s("p",[s("strong",[t._v("æ—¶é’ŸåŒæ­¥é—®é¢˜")]),s("br"),t._v("\nèŠ‚ç‚¹é—´æ—¶é’Ÿæ¼‚ç§»å¯èƒ½å¯¼è‡´é”æå‰å¤±æ•ˆã€‚å»ºè®®é€šè¿‡ NTP åè®®åŒæ­¥æ—¶é—´ã€‚")])]),t._v(" "),s("li",[s("p",[s("strong",[t._v("GC åœé¡¿é£é™©")]),s("br"),t._v("\nå®¢æˆ·ç«¯é•¿æ—¶é—´ GC å¯èƒ½å¯¼è‡´é”è¿‡æœŸåè¯¯æ“ä½œèµ„æºã€‚éœ€è®¾ç½®åˆç†çš„ TTL å¹¶ç›‘æ§ GC æ—¶é—´ã€‚")])]),t._v(" "),s("li",[s("p",[s("strong",[t._v("èŠ‚ç‚¹æ•…éšœæ¢å¤")]),s("br"),t._v("\nèŠ‚ç‚¹å´©æºƒåè‹¥æœªæŒä¹…åŒ–é”æ•°æ®ï¼Œæ¢å¤åå¯èƒ½ä¸å…¶ä»–èŠ‚ç‚¹çŠ¶æ€å†²çªã€‚å»ºè®®å¼€å¯ AOF æŒä¹…åŒ–ã€‚")])]),t._v(" "),s("li",[s("p",[s("strong",[t._v("æ€§èƒ½ä¸å¯é æ€§æƒè¡¡")])]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("å•èŠ‚ç‚¹é”")]),t._v("ï¼šæ€§èƒ½é«˜ï¼Œä½†å¯é æ€§ä½ï¼ˆä»…ç”¨äºéå…³é”®ä»»åŠ¡ï¼‰ã€‚")]),t._v(" "),s("li",[s("strong",[t._v("RedLock")]),t._v("ï¼šå¯é æ€§é«˜ï¼Œä½†å¤šèŠ‚ç‚¹é€šä¿¡å¢åŠ å»¶è¿Ÿï¼ˆé€‚åˆé‡‘èç­‰é«˜è¦æ±‚åœºæ™¯ï¼‰ã€‚")])])]),t._v(" "),s("li",[s("p",[s("strong",[t._v("é”ç²’åº¦æ§åˆ¶")]),s("br"),t._v("\né” Key éœ€ç²¾ç¡®åˆ°ä¸šåŠ¡èµ„æºï¼ˆå¦‚ "),s("code",[t._v("order_123")]),t._v("ï¼‰ï¼Œé¿å…å…¨å±€é”ç«äº‰ã€‚")])])]),t._v(" "),s("hr"),t._v(" "),s("h3",{attrs:{id:"ğŸ’-å››ã€ç”Ÿäº§ç¯å¢ƒæ¨èæ–¹æ¡ˆ"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ’-å››ã€ç”Ÿäº§ç¯å¢ƒæ¨èæ–¹æ¡ˆ"}},[t._v("#")]),t._v(" ğŸ’ å››ã€ç”Ÿäº§ç¯å¢ƒæ¨èæ–¹æ¡ˆ")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[s("strong",[t._v("åœºæ™¯")])]),t._v(" "),s("th",[s("strong",[t._v("æ–¹æ¡ˆ")])]),t._v(" "),s("th",[s("strong",[t._v("å·¥å…·")])])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("éå…³é”®ä»»åŠ¡ï¼ˆå¦‚ç¼“å­˜æ›´æ–°ï¼‰")]),t._v(" "),s("td",[t._v("å•èŠ‚ç‚¹é” + Lua é‡Šæ”¾")]),t._v(" "),s("td",[t._v("Spring Data Redis")])]),t._v(" "),s("tr",[s("td",[t._v("é«˜å¹¶å‘ä¸šåŠ¡ï¼ˆå¦‚è®¢å•æ”¯ä»˜ï¼‰")]),t._v(" "),s("td",[t._v("RedLock å¤šèŠ‚ç‚¹æŠ•ç¥¨")]),t._v(" "),s("td",[t._v("Redisson åº“")])]),t._v(" "),s("tr",[s("td",[t._v("å¼ºä¸€è‡´æ€§è¦æ±‚ï¼ˆå¦‚åº“å­˜æ‰£å‡ï¼‰")]),t._v(" "),s("td",[t._v("ç»“åˆæ•°æ®åº“äº‹åŠ¡ + Redis é”å…œåº•")]),t._v(" "),s("td",[t._v("Seata + Redisson")])])])]),t._v(" "),s("blockquote",[s("p",[s("strong",[t._v("æ³¨")]),t._v("ï¼šRedis Cluster çš„ 3ä¸»3ä»æ¶æ„ä¸­ï¼ŒRedLock åªéœ€æ“ä½œ 3 ä¸ªä¸»èŠ‚ç‚¹ï¼ˆN=3ï¼‰ï¼Œæ»¡è¶³ "),s("strong",[t._v("N/2 + 1 = 2")]),t._v(" çš„æˆåŠŸæ¡ä»¶å³å¯ã€‚")])]),t._v(" "),s("hr"),t._v(" "),s("h3",{attrs:{id:"ğŸ“š-äº”ã€æ‰©å±•é˜…è¯»-redlock-çš„äº‰è®®ä¸æ›¿ä»£"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ“š-äº”ã€æ‰©å±•é˜…è¯»-redlock-çš„äº‰è®®ä¸æ›¿ä»£"}},[t._v("#")]),t._v(" ğŸ“š äº”ã€æ‰©å±•é˜…è¯»ï¼šRedLock çš„äº‰è®®ä¸æ›¿ä»£")]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("äº‰è®®ç‚¹")]),t._v("ï¼šæç«¯åœºæ™¯ä¸‹ï¼ˆå¦‚ç½‘ç»œåˆ†åŒº + GC åœé¡¿ï¼‰ä»å¯èƒ½é”å¤±æ•ˆã€‚")]),t._v(" "),s("li",[s("strong",[t._v("æ›¿ä»£æ–¹æ¡ˆ")]),t._v("ï¼š\n"),s("ul",[s("li",[s("strong",[t._v("ZooKeeper é”")]),t._v("ï¼šåŸºäº ZAB åè®®å¼ºä¸€è‡´ï¼Œä½†æ€§èƒ½ä½äº Redisã€‚")]),t._v(" "),s("li",[s("strong",[t._v("etcd é”")]),t._v("ï¼šåŸºäº Raft åè®®ï¼Œé€‚åˆå¯¹ä¸€è‡´æ€§è¦æ±‚æé«˜çš„åœºæ™¯ã€‚")])])])]),t._v(" "),s("p",[t._v("å»ºè®®æ ¹æ®ä¸šåŠ¡å®¹å¿åº¦é€‰æ‹©æ–¹æ¡ˆï¼šRedis é”é€‚ç”¨äº "),s("strong",[t._v("AP ç³»ç»Ÿ")]),t._v("ï¼ˆé«˜å¯ç”¨ä¼˜å…ˆï¼‰ï¼ŒZK/etcd é€‚ç”¨äº "),s("strong",[t._v("CP ç³»ç»Ÿ")]),t._v("ï¼ˆå¼ºä¸€è‡´ä¼˜å…ˆï¼‰ã€‚")])])}),[],!1,null,null,null);s.default=r.exports}}]);