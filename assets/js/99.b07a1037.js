(window.webpackJsonp=window.webpackJsonp||[]).push([[99],{456:function(r,t,e){"use strict";e.r(t);var v=e(7),a=Object(v.a)({},(function(){var r=this,t=r._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":r.$parent.slotKey}},[t("p",[r._v("以下是基于 3 个 Broker、某 Topic 包含 "),t("strong",[r._v("10 个分区")]),r._v("且"),t("strong",[r._v("副本数=3")]),r._v(" 的具体分布图及分配逻辑详解（依据 Kafka 默认的 Round-Robin 副本分配算法）：")]),r._v(" "),t("hr"),r._v(" "),t("h3",{attrs:{id:"📊-一、分区与副本分布图"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#📊-一、分区与副本分布图"}},[r._v("#")]),r._v(" 📊 "),t("strong",[r._v("一、分区与副本分布图")])]),r._v(" "),t("table",[t("thead",[t("tr",[t("th",[t("strong",[r._v("分区")])]),r._v(" "),t("th",[t("strong",[r._v("Leader 所在 Broker")])]),r._v(" "),t("th",[t("strong",[r._v("Follower1 所在 Broker")])]),r._v(" "),t("th",[t("strong",[r._v("Follower2 所在 Broker")])])])]),r._v(" "),t("tbody",[t("tr",[t("td",[r._v("Partition 0")]),r._v(" "),t("td",[r._v("Broker 0")]),r._v(" "),t("td",[r._v("Broker 1")]),r._v(" "),t("td",[r._v("Broker 2")])]),r._v(" "),t("tr",[t("td",[r._v("Partition 1")]),r._v(" "),t("td",[r._v("Broker 1")]),r._v(" "),t("td",[r._v("Broker 2")]),r._v(" "),t("td",[r._v("Broker 0")])]),r._v(" "),t("tr",[t("td",[r._v("Partition 2")]),r._v(" "),t("td",[r._v("Broker 2")]),r._v(" "),t("td",[r._v("Broker 0")]),r._v(" "),t("td",[r._v("Broker 1")])]),r._v(" "),t("tr",[t("td",[r._v("Partition 3")]),r._v(" "),t("td",[r._v("Broker 0")]),r._v(" "),t("td",[r._v("Broker 1")]),r._v(" "),t("td",[r._v("Broker 2")])]),r._v(" "),t("tr",[t("td",[r._v("Partition 4")]),r._v(" "),t("td",[r._v("Broker 1")]),r._v(" "),t("td",[r._v("Broker 2")]),r._v(" "),t("td",[r._v("Broker 0")])]),r._v(" "),t("tr",[t("td",[r._v("Partition 5")]),r._v(" "),t("td",[r._v("Broker 2")]),r._v(" "),t("td",[r._v("Broker 0")]),r._v(" "),t("td",[r._v("Broker 1")])]),r._v(" "),t("tr",[t("td",[r._v("Partition 6")]),r._v(" "),t("td",[r._v("Broker 0")]),r._v(" "),t("td",[r._v("Broker 1")]),r._v(" "),t("td",[r._v("Broker 2")])]),r._v(" "),t("tr",[t("td",[r._v("Partition 7")]),r._v(" "),t("td",[r._v("Broker 1")]),r._v(" "),t("td",[r._v("Broker 2")]),r._v(" "),t("td",[r._v("Broker 0")])]),r._v(" "),t("tr",[t("td",[r._v("Partition 8")]),r._v(" "),t("td",[r._v("Broker 2")]),r._v(" "),t("td",[r._v("Broker 0")]),r._v(" "),t("td",[r._v("Broker 1")])]),r._v(" "),t("tr",[t("td",[r._v("Partition 9")]),r._v(" "),t("td",[r._v("Broker 0")]),r._v(" "),t("td",[r._v("Broker 1")]),r._v(" "),t("td",[r._v("Broker 2")])])])]),r._v(" "),t("hr"),r._v(" "),t("h3",{attrs:{id:"📌-二、分布示意图-按-broker-视角"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#📌-二、分布示意图-按-broker-视角"}},[r._v("#")]),r._v(" 📌 "),t("strong",[r._v("二、分布示意图（按 Broker 视角）")])]),r._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[r._v("Broker 0：\n  Partition 0 (Leader)\n  Partition 1 (Follower2)\n  Partition 2 (Follower1)\n  Partition 3 (Leader)\n  Partition 5 (Follower1)\n  Partition 6 (Leader)\n  Partition 8 (Follower2)\n  Partition 9 (Leader)   → 共承载 4 Leader + 4 Follower\n\nBroker 1：\n  Partition 0 (Follower1)\n  Partition 1 (Leader)\n  Partition 2 (Follower2)\n  Partition 3 (Follower1)\n  Partition 4 (Leader)\n  Partition 6 (Follower1)\n  Partition 7 (Leader)\n  Partition 9 (Follower1) → 共承载 3 Leader + 5 Follower\n\nBroker 2：\n  Partition 0 (Follower2)\n  Partition 1 (Follower1)\n  Partition 2 (Leader)\n  Partition 4 (Follower2)\n  Partition 5 (Leader)\n  Partition 7 (Follower2)\n  Partition 8 (Follower1)  → 共承载 3 Leader + 4 Follower\n")])]),r._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[r._v("1")]),t("br"),t("span",{staticClass:"line-number"},[r._v("2")]),t("br"),t("span",{staticClass:"line-number"},[r._v("3")]),t("br"),t("span",{staticClass:"line-number"},[r._v("4")]),t("br"),t("span",{staticClass:"line-number"},[r._v("5")]),t("br"),t("span",{staticClass:"line-number"},[r._v("6")]),t("br"),t("span",{staticClass:"line-number"},[r._v("7")]),t("br"),t("span",{staticClass:"line-number"},[r._v("8")]),t("br"),t("span",{staticClass:"line-number"},[r._v("9")]),t("br"),t("span",{staticClass:"line-number"},[r._v("10")]),t("br"),t("span",{staticClass:"line-number"},[r._v("11")]),t("br"),t("span",{staticClass:"line-number"},[r._v("12")]),t("br"),t("span",{staticClass:"line-number"},[r._v("13")]),t("br"),t("span",{staticClass:"line-number"},[r._v("14")]),t("br"),t("span",{staticClass:"line-number"},[r._v("15")]),t("br"),t("span",{staticClass:"line-number"},[r._v("16")]),t("br"),t("span",{staticClass:"line-number"},[r._v("17")]),t("br"),t("span",{staticClass:"line-number"},[r._v("18")]),t("br"),t("span",{staticClass:"line-number"},[r._v("19")]),t("br"),t("span",{staticClass:"line-number"},[r._v("20")]),t("br"),t("span",{staticClass:"line-number"},[r._v("21")]),t("br"),t("span",{staticClass:"line-number"},[r._v("22")]),t("br"),t("span",{staticClass:"line-number"},[r._v("23")]),t("br"),t("span",{staticClass:"line-number"},[r._v("24")]),t("br"),t("span",{staticClass:"line-number"},[r._v("25")]),t("br"),t("span",{staticClass:"line-number"},[r._v("26")]),t("br"),t("span",{staticClass:"line-number"},[r._v("27")]),t("br"),t("span",{staticClass:"line-number"},[r._v("28")]),t("br")])]),t("blockquote",[t("p",[r._v("✅ "),t("strong",[r._v("负载均衡")]),r._v("：Leader 均匀分散（Broker0:4个、Broker1:3个、Broker2:3个），避免单点压力。")])]),r._v(" "),t("hr"),r._v(" "),t("h3",{attrs:{id:"⚙️-三、分配算法逻辑"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#⚙️-三、分配算法逻辑"}},[r._v("#")]),r._v(" ⚙️ "),t("strong",[r._v("三、分配算法逻辑")])]),r._v(" "),t("ol",[t("li",[t("p",[t("strong",[r._v("Leader 分配规则")]),r._v("："),t("br"),r._v("\n第 "),t("code",[r._v("i")]),r._v(" 个分区的 Leader 分配到 "),t("code",[r._v("Broker (i mod 3)")]),t("br"),r._v(" "),t("em",[r._v("示例：")])]),r._v(" "),t("ul",[t("li",[r._v("Partition 0 → "),t("code",[r._v("0 mod 3 = 0")]),r._v(" → "),t("strong",[r._v("Broker 0")])]),r._v(" "),t("li",[r._v("Partition 1 → "),t("code",[r._v("1 mod 3 = 1")]),r._v(" → "),t("strong",[r._v("Broker 1")])])])]),r._v(" "),t("li",[t("p",[t("strong",[r._v("Follower 分配规则")]),r._v("："),t("br"),r._v("\n第 "),t("code",[r._v("j")]),r._v(" 个副本（Follower）分配到 "),t("code",[r._v("Broker (i + j) mod 3")]),t("br"),r._v(" "),t("em",[r._v("示例（Partition 0）")]),r._v("：")]),r._v(" "),t("ul",[t("li",[r._v("Follower1（j=1）→ "),t("code",[r._v("(0 + 1) mod 3 = 1")]),r._v(" → "),t("strong",[r._v("Broker 1")])]),r._v(" "),t("li",[r._v("Follower2（j=2）→ "),t("code",[r._v("(0 + 2) mod 3 = 2")]),r._v(" → "),t("strong",[r._v("Broker 2")])])])])]),r._v(" "),t("hr"),r._v(" "),t("h3",{attrs:{id:"⚠️-四、容错能力说明"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#⚠️-四、容错能力说明"}},[r._v("#")]),r._v(" ⚠️ "),t("strong",[r._v("四、容错能力说明")])]),r._v(" "),t("ul",[t("li",[t("strong",[r._v("副本分布原则")]),r._v("：同一分区的 3 个副本"),t("strong",[r._v("绝不共存于同一 Broker")]),r._v("（如 Partition 0 分布在 Broker0/1/2）。")]),r._v(" "),t("li",[t("strong",[r._v("故障容忍")]),r._v("：\n"),t("ul",[t("li",[r._v("若任意 1 个 Broker 宕机（如 Broker0），剩余 Broker 仍包含所有分区的完整副本集。")]),r._v(" "),t("li",[r._v("例如 Broker0 宕机时：\n"),t("ul",[t("li",[r._v("Partition 0 的新 Leader 可从 Broker1 或 Broker2 选举（原 Follower 升级为 Leader）。")])])])])])]),r._v(" "),t("hr"),r._v(" "),t("h3",{attrs:{id:"💎-总结"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#💎-总结"}},[r._v("#")]),r._v(" 💎 "),t("strong",[r._v("总结")])]),r._v(" "),t("ul",[t("li",[t("strong",[r._v("副本数上限")]),r._v("：3 个 Broker 时，副本数最大为 "),t("strong",[r._v("3")]),r._v("（受限于 Broker 数量）。")]),r._v(" "),t("li",[t("strong",[r._v("分区均匀性")]),r._v("：10 分区无法整除 3，故 Broker 承载分区数存在差异（4/3/3），但 Leader 分布基本均衡。")]),r._v(" "),t("li",[t("strong",[r._v("生产建议")]),r._v("：\n"),t("ul",[t("li",[r._v("副本数固定为 "),t("strong",[r._v("3")]),r._v("（容忍单节点故障）；")]),r._v(" "),t("li",[r._v("使用命令验证分布："),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[r._v("kafka-topics.sh "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[r._v("--describe")]),r._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[r._v("--topic")]),r._v(" your-topic --bootstrap-server localhost:9092\n")])]),r._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[r._v("1")]),t("br")])])])])])])])}),[],!1,null,null,null);t.default=a.exports}}]);