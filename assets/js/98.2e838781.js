(window.webpackJsonp=window.webpackJsonp||[]).push([[98],{455:function(_,t,v){"use strict";v.r(t);var r=v(7),s=Object(r.a)({},(function(){var _=this,t=_._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":_.$parent.slotKey}},[t("p",[_._v("在 Kafka 中，"),t("strong",[_._v("分区数（Partitions）")]),_._v(" 和 "),t("strong",[_._v("副本数（Replication Factor）")]),_._v(" 是两个核心概念，分别承担不同的角色，共同保障系统的性能、可靠性与扩展性。以下是两者的详细区别及作用解析：")]),_._v(" "),t("hr"),_._v(" "),t("h3",{attrs:{id:"🧩-一、核心定义"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#🧩-一、核心定义"}},[_._v("#")]),_._v(" 🧩 "),t("strong",[_._v("一、核心定义")])]),_._v(" "),t("table",[t("thead",[t("tr",[t("th",[t("strong",[_._v("维度")])]),_._v(" "),t("th",[t("strong",[_._v("分区数（Partitions）")])]),_._v(" "),t("th",[t("strong",[_._v("副本数（Replication Factor）")])])])]),_._v(" "),t("tbody",[t("tr",[t("td",[t("strong",[_._v("本质")])]),_._v(" "),t("td",[_._v("Topic 的物理分片单位，每个分区是一个有序队列")]),_._v(" "),t("td",[_._v("每个分区的数据冗余备份数量")])]),_._v(" "),t("tr",[t("td",[t("strong",[_._v("作用目标")])]),_._v(" "),t("td",[_._v("解决 "),t("strong",[_._v("并行处理与负载均衡")]),_._v(" 问题")]),_._v(" "),t("td",[_._v("解决 "),t("strong",[_._v("数据高可用与容错")]),_._v(" 问题")])]),_._v(" "),t("tr",[t("td",[t("strong",[_._v("最小单位")])]),_._v(" "),t("td",[_._v("1 个分区（默认值）")]),_._v(" "),t("td",[_._v("1 个副本（无冗余）")])])])]),_._v(" "),t("hr"),_._v(" "),t("h3",{attrs:{id:"⚙️-二、功能作用对比"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#⚙️-二、功能作用对比"}},[_._v("#")]),_._v(" ⚙️ "),t("strong",[_._v("二、功能作用对比")])]),_._v(" "),t("h4",{attrs:{id:"_1-分区数-partitions"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-分区数-partitions"}},[_._v("#")]),_._v(" "),t("strong",[_._v("1. 分区数（Partitions）")])]),_._v(" "),t("ul",[t("li",[t("strong",[_._v("扩展性与并行性")]),t("br"),_._v("\n分区将 Topic 数据拆分为多个子队列，允许：\n"),t("ul",[t("li",[_._v("生产者并行写入不同分区；")]),_._v(" "),t("li",[_._v("消费者组内多个消费者并发消费不同分区（一个分区仅由组内一个消费者消费）。")])])]),_._v(" "),t("li",[t("strong",[_._v("负载均衡")]),t("br"),_._v("\n数据通过轮询或哈希策略分布到不同分区，避免单 Broker 成为瓶颈。")]),_._v(" "),t("li",[t("strong",[_._v("顺序性保证")]),t("br"),_._v("\n分区内消息有序，分区间无序。需顺序处理的消息必须写入同一分区（如订单流水）。")])]),_._v(" "),t("h4",{attrs:{id:"_2-副本数-replication-factor"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-副本数-replication-factor"}},[_._v("#")]),_._v(" "),t("strong",[_._v("2. 副本数（Replication Factor）")])]),_._v(" "),t("ul",[t("li",[t("strong",[_._v("容错性与高可用")]),t("br"),_._v("\n每个分区的副本分布在多个 Broker 上：\n"),t("ul",[t("li",[t("strong",[_._v("Leader 副本")]),_._v("：处理读写请求；")]),_._v(" "),t("li",[t("strong",[_._v("Follower 副本")]),_._v("：异步/同步从 Leader 复制数据。")]),_._v(" "),t("li",[t("strong",[_._v("故障转移")]),_._v("：Leader 宕机时，从 Follower 副本选举新 Leader。")])])]),_._v(" "),t("li",[t("strong",[_._v("数据可靠性")]),t("br"),_._v("\n副本数 "),t("code",[_._v("N")]),_._v(" 可容忍 "),t("code",[_._v("N-1")]),_._v(" 个 Broker 故障（例如 3 副本容忍 2 节点故障）。")])]),_._v(" "),t("hr"),_._v(" "),t("h3",{attrs:{id:"📊-三、配置与约束"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#📊-三、配置与约束"}},[_._v("#")]),_._v(" 📊 "),t("strong",[_._v("三、配置与约束")])]),_._v(" "),t("table",[t("thead",[t("tr",[t("th",[t("strong",[_._v("维度")])]),_._v(" "),t("th",[t("strong",[_._v("分区数")])]),_._v(" "),t("th",[t("strong",[_._v("副本数")])])])]),_._v(" "),t("tbody",[t("tr",[t("td",[t("strong",[_._v("创建后修改")])]),_._v(" "),t("td",[_._v("✅ 可增加（"),t("code",[_._v("kafka-topics.sh --alter")]),_._v("），不可减少")]),_._v(" "),t("td",[_._v("❌ 不可修改（需重建 Topic 或调整副本分布）")])]),_._v(" "),t("tr",[t("td",[t("strong",[_._v("数量限制")])]),_._v(" "),t("td",[_._v("无硬性上限，但单 Broker 建议 ≤200 分区")]),_._v(" "),t("td",[_._v("≤ Broker 数量（如 3 Broker 时副本数 ≤3）")])]),_._v(" "),t("tr",[t("td",[t("strong",[_._v("性能影响")])]),_._v(" "),t("td",[_._v("过多分区导致元数据膨胀、选举延迟")]),_._v(" "),t("td",[_._v("副本越多，写入延迟越高（需同步更多节点）")])])])]),_._v(" "),t("hr"),_._v(" "),t("h3",{attrs:{id:"⚖️-四、生产环境配置建议"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#⚖️-四、生产环境配置建议"}},[_._v("#")]),_._v(" ⚖️ "),t("strong",[_._v("四、生产环境配置建议")])]),_._v(" "),t("h4",{attrs:{id:"_1-分区数设置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-分区数设置"}},[_._v("#")]),_._v(" "),t("strong",[_._v("1. 分区数设置")])]),_._v(" "),t("ul",[t("li",[t("strong",[_._v("计算公式")]),_._v("："),t("br"),_._v(" "),t("code",[_._v("分区数 = max(目标生产吞吐量 / 单分区吞吐, 目标消费吞吐量 / 单分区消费能力)")]),t("br"),_._v("\n（单分区吞吐参考值：生产 10MB/s，消费 10MB/s）")]),_._v(" "),t("li",[t("strong",[_._v("场景示例")]),_._v("：\n"),t("ul",[t("li",[_._v("低吞吐日志：1~3 分区；")]),_._v(" "),t("li",[_._v("订单系统：10~30 分区（匹配消费者实例数 ×2）；")]),_._v(" "),t("li",[_._v("流处理高吞吐：按公式动态扩展。")])])])]),_._v(" "),t("h4",{attrs:{id:"_2-副本数设置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-副本数设置"}},[_._v("#")]),_._v(" "),t("strong",[_._v("2. 副本数设置")])]),_._v(" "),t("ul",[t("li",[t("p",[t("strong",[_._v("推荐值")]),_._v("：")]),_._v(" "),t("table",[t("thead",[t("tr",[t("th",[t("strong",[_._v("环境")])]),_._v(" "),t("th",[t("strong",[_._v("副本数")])]),_._v(" "),t("th",[t("strong",[_._v("容错能力")])])])]),_._v(" "),t("tbody",[t("tr",[t("td",[_._v("开发/测试")]),_._v(" "),t("td",[_._v("1~2")]),_._v(" "),t("td",[_._v("无或弱容错")])]),_._v(" "),t("tr",[t("td",[t("strong",[_._v("生产环境")])]),_._v(" "),t("td",[t("strong",[_._v("≥3")])]),_._v(" "),t("td",[_._v("容忍 1~2 节点故障")])]),_._v(" "),t("tr",[t("td",[_._v("金融级系统")]),_._v(" "),t("td",[_._v("3~5")]),_._v(" "),t("td",[_._v("容忍 2~4 节点故障")])])])])]),_._v(" "),t("li",[t("p",[t("strong",[_._v("关键参数")]),_._v("：")]),_._v(" "),t("ul",[t("li",[t("code",[_._v("min.insync.replicas")]),_._v("：最小同步副本数（建议=2，配合 "),t("code",[_._v("acks=all")]),_._v(" 使用）；")]),_._v(" "),t("li",[t("code",[_._v("unclean.leader.election.enable=false")]),_._v("：禁止非同步副本成为 Leader。")])])])]),_._v(" "),t("hr"),_._v(" "),t("h3",{attrs:{id:"💎-总结-核心差异一句话"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#💎-总结-核心差异一句话"}},[_._v("#")]),_._v(" 💎 "),t("strong",[_._v("总结：核心差异一句话")])]),_._v(" "),t("blockquote",[t("p",[t("strong",[_._v("分区是水平扩展的刀，切割数据以提升并发；副本是容错的盾，复制数据以抵御故障。")])]),_._v(" "),t("ul",[t("li",[t("strong",[_._v("分区数")]),_._v(" → 定义 "),t("strong",[_._v("并行能力上限")]),_._v("（消费者线程数 ≤ 分区数）；")]),_._v(" "),t("li",[t("strong",[_._v("副本数")]),_._v(" → 定义 "),t("strong",[_._v("数据生存能力")]),_._v("（副本数越高，数据越难丢失）。")])])]),_._v(" "),t("p",[_._v("实际部署需结合集群规模（如 3 Broker 时副本数最大为 3）、业务吞吐及容灾需求综合设计，避免过度配置引发性能损耗。")])])}),[],!1,null,null,null);t.default=s.exports}}]);