(window.webpackJsonp=window.webpackJsonp||[]).push([[55],{413:function(_,v,o){"use strict";o.r(v);var e=o(7),n=Object(e.a)({},(function(){var _=this,v=_._self._c;return v("ContentSlotsDistributor",{attrs:{"slot-key":_.$parent.slotKey}},[v("p",[_._v("在MySQL InnoDB引擎中，MVCC的实现依赖3个系统隐式字段，其中包含一个可选字段。以下是具体说明：")]),_._v(" "),v("hr"),_._v(" "),v("p",[_._v("一、"),v("strong",[_._v("核心隐藏字段")])]),_._v(" "),v("ol",[v("li",[v("p",[v("code",[_._v("DB_TRX_ID")]),_._v("（6字节）")]),_._v(" "),v("p",[_._v("• 作用：记录最后一次修改（插入、更新或删除）该行的事务ID。")]),_._v(" "),v("p",[_._v("• 可见性判断：通过对比事务ID与Read View中的"),v("code",[_._v("m_ids")]),_._v("、"),v("code",[_._v("min_trx_id")]),_._v("等参数，确定数据版本是否对当前事务可见。")])]),_._v(" "),v("li",[v("p",[v("code",[_._v("DB_ROLL_PTR")]),_._v("（7字节）")]),_._v(" "),v("p",[_._v("• 作用：回滚指针，指向Undo Log中该行数据的历史版本，形成多版本链。")]),_._v(" "),v("p",[_._v("• 版本回溯：通过该指针遍历Undo Log中的旧版本，找到满足事务可见性条件的版本。")])]),_._v(" "),v("li",[v("p",[v("code",[_._v("DB_ROW_ID")]),_._v("（6字节，可选）")]),_._v(" "),v("p",[_._v("• 触发条件：当表未显式定义主键且无唯一索引时，InnoDB自动生成此字段作为隐藏主键。")]),_._v(" "),v("p",[_._v("• 用途：用于构建聚簇索引，但不直接参与MVCC的可见性判断。")])])]),_._v(" "),v("hr"),_._v(" "),v("p",[_._v("二、"),v("strong",[_._v("删除标记（逻辑删除机制）")])]),_._v(" "),v("p",[_._v("• 实现方式：")]),_._v(" "),v("p",[_._v("• InnoDB不单独使用"),v("code",[_._v("flag")]),_._v("字段，而是通过事务ID和Undo Log标记数据失效。")]),_._v(" "),v("p",[_._v("• 例如，删除操作会更新"),v("code",[_._v("DB_TRX_ID")]),_._v("为当前事务ID，并将旧数据写入Undo Log，通过"),v("code",[_._v("DB_ROLL_PTR")]),_._v("形成版本链。")]),_._v(" "),v("p",[_._v("• 清理机制：")]),_._v(" "),v("p",[_._v("• 后台"),v("code",[_._v("purge")]),_._v("线程根据事务提交状态清理失效版本，而非物理删除数据。")]),_._v(" "),v("hr"),_._v(" "),v("p",[_._v("三、"),v("strong",[_._v("与其他数据库的对比")])]),_._v(" "),v("p",[_._v("• PostgreSQL：通过"),v("code",[_._v("xmin")]),_._v("（插入事务ID）和"),v("code",[_._v("xmax")]),_._v("（删除/更新事务ID）管理版本生命周期，未采用隐藏"),v("code",[_._v("flag")]),_._v("字段。")]),_._v(" "),v("p",[_._v("• MySQL逻辑删除与PostgreSQL的差异：")]),_._v(" "),v("p",[_._v("• MySQL通过事务ID隐式标记删除状态，PostgreSQL直接使用"),v("code",[_._v("xmax")]),_._v("字段记录失效事务ID。")]),_._v(" "),v("hr"),_._v(" "),v("p",[_._v("四、"),v("strong",[_._v("总结")])]),_._v(" "),v("p",[_._v("• 标准隐藏字段："),v("code",[_._v("DB_TRX_ID")]),_._v("、"),v("code",[_._v("DB_ROLL_PTR")]),_._v("、"),v("code",[_._v("DB_ROW_ID")]),_._v("（仅无主键时存在）。")]),_._v(" "),v("p",[_._v("• 删除标记：通过事务ID和Undo Log实现逻辑删除，无需单独"),v("code",[_._v("flag")]),_._v("字段。")]),_._v(" "),v("p",[_._v("通过上述机制，MySQL InnoDB在保证事务隔离性的同时，实现了非阻塞读写的高并发性能。")])])}),[],!1,null,null,null);v.default=n.exports}}]);