(window.webpackJsonp=window.webpackJsonp||[]).push([[60],{417:function(s,a,t){"use strict";t.r(a);var e=t(7),n=Object(e.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("p",[s._v("ä»¥ä¸‹æ˜¯é€šè¿‡ Docker æ­å»º Redis é›†ç¾¤çš„å®Œæ•´æ–¹æ¡ˆï¼Œæ¶µç›–å•æœºå¿«é€Ÿéƒ¨ç½²ã€å¤šæœºç”Ÿäº§çº§éƒ¨ç½²ã€éªŒè¯æµ‹è¯•åŠæ‰©å®¹ç®¡ç†ï¼Œç»“åˆå¤šä¸ªæ¥æºçš„æœ€ä½³å®è·µæ•´ç†è€Œæˆï¼š")]),s._v(" "),a("hr"),s._v(" "),a("h3",{attrs:{id:"ğŸ”§-ä¸€ã€å•æœºå¿«é€Ÿæ­å»º-å¼€å‘æµ‹è¯•"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ”§-ä¸€ã€å•æœºå¿«é€Ÿæ­å»º-å¼€å‘æµ‹è¯•"}},[s._v("#")]),s._v(" ğŸ”§ "),a("strong",[s._v("ä¸€ã€å•æœºå¿«é€Ÿæ­å»ºï¼ˆå¼€å‘æµ‹è¯•ï¼‰")])]),s._v(" "),a("p",[s._v("é€‚ç”¨äºæœ¬åœ°å­¦ä¹ æˆ–æµ‹è¯•ç¯å¢ƒï¼Œä¸€å°æœºå™¨æ¨¡æ‹Ÿå¤šèŠ‚ç‚¹é›†ç¾¤ã€‚")]),s._v(" "),a("h4",{attrs:{id:"æ­¥éª¤"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#æ­¥éª¤"}},[s._v("#")]),s._v(" "),a("strong",[s._v("æ­¥éª¤")]),s._v("ï¼š")]),s._v(" "),a("ol",[a("li",[a("p",[a("strong",[s._v("ç¼–å†™ "),a("code",[s._v("docker-compose.yml")])]),a("br"),s._v("\nåˆ›å»º 6 ä¸ªèŠ‚ç‚¹ï¼ˆ3 ä¸» 3 ä»ï¼‰ï¼š")]),s._v(" "),a("div",{staticClass:"language-yaml line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("version")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'3.7'")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("services")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("redis-node1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" redis"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("latest\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ports")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"6371:6379"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"16371:16379"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("command")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" redis"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("server "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("cluster"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("enabled yes "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("cluster"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("config"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("file nodes.conf "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("cluster"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("node"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("timeout 5000 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("appendonly yes\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# é‡å¤é…ç½® redis-node2 åˆ° redis-node6ï¼ˆç«¯å£é€’å¢ï¼š6372-6376, 16372-16376ï¼‰")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("å¯åŠ¨å®¹å™¨")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker-compose")]),s._v(" up "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("åˆ›å»ºé›†ç¾¤")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-it")]),s._v(" redis-node1 redis-cli "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--cluster")]),s._v(" create "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.18")]),s._v(".0.2:6379 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.18")]),s._v(".0.3:6379 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.18")]),s._v(".0.4:6379 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.18")]),s._v(".0.5:6379 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.18")]),s._v(".0.6:6379 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.18")]),s._v(".0.7:6379 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  --cluster-replicas "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("ul",[a("li",[a("code",[s._v("--cluster-replicas 1")]),s._v("ï¼šæ¯ä¸ªä¸»èŠ‚ç‚¹é… 1 ä¸ªä»èŠ‚ç‚¹ã€‚")])])])]),s._v(" "),a("hr"),s._v(" "),a("h3",{attrs:{id:"âš™ï¸-äºŒã€å¤šæœºç”Ÿäº§éƒ¨ç½²-3-å°æœåŠ¡å™¨"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#âš™ï¸-äºŒã€å¤šæœºç”Ÿäº§éƒ¨ç½²-3-å°æœåŠ¡å™¨"}},[s._v("#")]),s._v(" âš™ï¸ "),a("strong",[s._v("äºŒã€å¤šæœºç”Ÿäº§éƒ¨ç½²ï¼ˆ3 å°æœåŠ¡å™¨ï¼‰")])]),s._v(" "),a("p",[s._v("è·¨ç‰©ç†æœºéƒ¨ç½²ï¼Œä¿éšœé«˜å¯ç”¨ã€‚")]),s._v(" "),a("h4",{attrs:{id:"æ­¥éª¤-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#æ­¥éª¤-2"}},[s._v("#")]),s._v(" "),a("strong",[s._v("æ­¥éª¤")]),s._v("ï¼š")]),s._v(" "),a("ol",[a("li",[a("p",[a("strong",[s._v("æ¯å°æœåŠ¡å™¨éƒ¨ç½² 2 ä¸ªèŠ‚ç‚¹")]),s._v("ï¼ˆå…± 6 èŠ‚ç‚¹ï¼‰")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# æœåŠ¡å™¨ 1ï¼ˆ172.16.17.100ï¼‰")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--name")]),s._v(" redis-7000 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7000")]),s._v(":7000 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("17000")]),s._v(":17000 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-e")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("CLUSTER_ANNOUNCE_IP")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.16")]),s._v(".17.100 redis:latest "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  redis-server --cluster-enabled "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("yes")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--port")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7000")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# åŒæœåŠ¡å™¨å¯åŠ¨ redis-7001ï¼ˆç«¯å£ 7001/17001ï¼‰")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("blockquote",[a("p",[a("strong",[s._v("é‡å¤æ“ä½œ")]),s._v("ï¼š")]),s._v(" "),a("ul",[a("li",[s._v("æœåŠ¡å™¨ 2ï¼ˆ172.16.17.101ï¼‰ï¼šéƒ¨ç½² "),a("code",[s._v("redis-7002")]),s._v("ã€"),a("code",[s._v("redis-7003")])]),s._v(" "),a("li",[s._v("æœåŠ¡å™¨ 3ï¼ˆ172.16.17.102ï¼‰ï¼šéƒ¨ç½² "),a("code",[s._v("redis-7004")]),s._v("ã€"),a("code",[s._v("redis-7005")]),s._v("ã€‚")])])])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("åˆ›å»ºé›†ç¾¤")]),s._v("ï¼ˆä»»æ„ä¸€å°æœåŠ¡å™¨æ‰§è¡Œï¼‰")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-it")]),s._v(" redis-7000 redis-cli "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--cluster")]),s._v(" create "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.16")]),s._v(".17.100:7000 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.16")]),s._v(".17.100:7001 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.16")]),s._v(".17.101:7002 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.16")]),s._v(".17.101:7003 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.16")]),s._v(".17.102:7004 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.16")]),s._v(".17.102:7005 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  --cluster-replicas "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("ul",[a("li",[a("strong",[s._v("è‡ªåŠ¨åˆ†é…")]),s._v("ï¼šä¸»ä»èŠ‚ç‚¹ä¼šè·¨ç‰©ç†æœºåˆ†å¸ƒï¼ˆå¦‚ä¸»èŠ‚ç‚¹åœ¨æœåŠ¡å™¨1ï¼Œä»èŠ‚ç‚¹åœ¨æœåŠ¡å™¨2ï¼‰ã€‚")])])])]),s._v(" "),a("hr"),s._v(" "),a("h3",{attrs:{id:"âœ…-ä¸‰ã€é›†ç¾¤éªŒè¯ä¸æµ‹è¯•"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#âœ…-ä¸‰ã€é›†ç¾¤éªŒè¯ä¸æµ‹è¯•"}},[s._v("#")]),s._v(" âœ… "),a("strong",[s._v("ä¸‰ã€é›†ç¾¤éªŒè¯ä¸æµ‹è¯•")])]),s._v(" "),a("p",[s._v("ç¡®ä¿é›†ç¾¤æ­£å¸¸å·¥ä½œå¹¶å…·å¤‡å®¹é”™èƒ½åŠ›ã€‚")]),s._v(" "),a("ol",[a("li",[a("p",[a("strong",[s._v("æ£€æŸ¥é›†ç¾¤çŠ¶æ€")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-it")]),s._v(" redis-7000 redis-cli cluster nodes\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[a("strong",[s._v("é¢„æœŸè¾“å‡º")]),s._v("ï¼š")]),s._v(" "),a("ul",[a("li",[s._v("3 ä¸ª "),a("code",[s._v("master")]),s._v(" åœ¨çº¿ï¼Œæ¯ä¸ª "),a("code",[s._v("master")]),s._v(" æœ‰ 1 ä¸ª "),a("code",[s._v("slave")])]),s._v(" "),a("li",[s._v("æ‰€æœ‰ Slotï¼ˆ16384 ä¸ªï¼‰å·²åˆ†é…å®Œæˆã€‚")])])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("æ•°æ®è¯»å†™æµ‹è¯•")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# èŠ‚ç‚¹1å†™å…¥")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-it")]),s._v(" redis-7000 redis-cli "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-c")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" user:101 "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Alice"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# èŠ‚ç‚¹2è¯»å–ï¼ˆè‡ªåŠ¨é‡å®šå‘ï¼‰")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-it")]),s._v(" redis-7002 redis-cli "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-c")]),s._v(" get user:101  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# è¿”å› "Alice"')]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("æ•…éšœè½¬ç§»æµ‹è¯•")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# åœæ­¢ä¸»èŠ‚ç‚¹")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" stop redis-7000\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ç­‰å¾… 15 ç§’ï¼ˆcluster-node-timeoutï¼‰ï¼Œæ£€æŸ¥ä»èŠ‚ç‚¹æ˜¯å¦å‡ä¸»")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-it")]),s._v(" redis-7001 redis-cli cluster nodes "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" master\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])])])]),s._v(" "),a("hr"),s._v(" "),a("h3",{attrs:{id:"ğŸ› ï¸-å››ã€æ‰©å®¹ä¸ç®¡ç†"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ› ï¸-å››ã€æ‰©å®¹ä¸ç®¡ç†"}},[s._v("#")]),s._v(" ğŸ› ï¸ "),a("strong",[s._v("å››ã€æ‰©å®¹ä¸ç®¡ç†")])]),s._v(" "),a("h4",{attrs:{id:"æ‰©å®¹ä¸»èŠ‚ç‚¹"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#æ‰©å®¹ä¸»èŠ‚ç‚¹"}},[s._v("#")]),s._v(" "),a("strong",[s._v("æ‰©å®¹ä¸»èŠ‚ç‚¹")])]),s._v(" "),a("ol",[a("li",[a("strong",[s._v("æ–°å¢èŠ‚ç‚¹")]),s._v("ï¼ˆä¾‹å¦‚ç«¯å£ 7006ï¼‰"),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--name")]),s._v(" redis-7006 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7006")]),s._v(":7006 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("17006")]),s._v(":17006 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-e")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("CLUSTER_ANNOUNCE_IP")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.16")]),s._v(".17.103 redis:latest "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  redis-server --cluster-enabled "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("yes")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--port")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7006")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])])]),s._v(" "),a("li",[a("strong",[s._v("åŠ å…¥é›†ç¾¤å¹¶åˆ†é… Slot")]),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# åŠ å…¥é›†ç¾¤")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-it")]),s._v(" redis-7000 redis-cli "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--cluster")]),s._v(" add-node "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.16")]),s._v(".17.103:7006 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.16")]),s._v(".17.100:7000\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# åˆ†é… Slotï¼ˆä»å…¶ä»–ä¸»èŠ‚ç‚¹è¿ç§»ï¼‰")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-it")]),s._v(" redis-7000 redis-cli "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--cluster")]),s._v(" reshard "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.16")]),s._v(".17.103:7006 --cluster-from "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("æºèŠ‚ç‚¹ID"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" --cluster-slots "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])])])]),s._v(" "),a("h4",{attrs:{id:"æ—¥å¸¸è¿ç»´"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#æ—¥å¸¸è¿ç»´"}},[s._v("#")]),s._v(" "),a("strong",[s._v("æ—¥å¸¸è¿ç»´")])]),s._v(" "),a("table",[a("thead",[a("tr",[a("th",[a("strong",[s._v("æ“ä½œ")])]),s._v(" "),a("th",[a("strong",[s._v("å‘½ä»¤")])])])]),s._v(" "),a("tbody",[a("tr",[a("td",[s._v("èŠ‚ç‚¹å®‰å…¨å…³é—­")]),s._v(" "),a("td",[a("code",[s._v("docker stop redis-7000 && docker start redis-7000")])])]),s._v(" "),a("tr",[a("td",[s._v("é›†ç¾¤çŠ¶æ€æ£€æŸ¥")]),s._v(" "),a("td",[a("code",[s._v("docker exec -it redis-node1 redis-cli cluster info")])])]),s._v(" "),a("tr",[a("td",[s._v("å¤‡ä»½æ•°æ®")]),s._v(" "),a("td",[s._v("æŒ‚è½½æ•°æ®å·ï¼ˆ"),a("code",[s._v("-v /redis-data:/data")]),s._v("ï¼‰ï¼Œå®šæœŸå¤‡ä»½æŒä¹…åŒ–æ–‡ä»¶")])])])]),s._v(" "),a("hr"),s._v(" "),a("h3",{attrs:{id:"âš ï¸-å…³é”®é…ç½®ä¸é¿å‘æŒ‡å—"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#âš ï¸-å…³é”®é…ç½®ä¸é¿å‘æŒ‡å—"}},[s._v("#")]),s._v(" âš ï¸ "),a("strong",[s._v("å…³é”®é…ç½®ä¸é¿å‘æŒ‡å—")])]),s._v(" "),a("ol",[a("li",[a("p",[a("strong",[s._v("ç½‘ç»œè¦æ±‚")])]),s._v(" "),a("ul",[a("li",[s._v("èŠ‚ç‚¹é—´éœ€å¼€æ”¾"),a("strong",[s._v("å®¢æˆ·ç«¯ç«¯å£")]),s._v("ï¼ˆå¦‚ 6379ï¼‰å’Œ"),a("strong",[s._v("é›†ç¾¤æ€»çº¿ç«¯å£")]),s._v("ï¼ˆ+10000ï¼Œå¦‚ 16379ï¼‰ã€‚")]),s._v(" "),a("li",[s._v("è·¨æœåŠ¡å™¨æ—¶ç¦ç”¨é˜²ç«å¢™æˆ–æ”¾è¡Œç«¯å£ï¼š"),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("firewall-cmd --add-port"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7000")]),s._v("-7005"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("/tcp "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--permanent")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" firewall-cmd "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--reload")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])])])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("é…ç½®ä¸€è‡´æ€§")])]),s._v(" "),a("ul",[a("li",[s._v("æ‰€æœ‰èŠ‚ç‚¹éœ€å¯ç”¨é›†ç¾¤æ¨¡å¼ï¼š"),a("div",{staticClass:"language-ini line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-ini"}},[a("code",[s._v("cluster-enabled yes\ncluster-node-timeout 15000  # è¶…æ—¶æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])])]),s._v(" "),a("li",[s._v("ç”Ÿäº§ç¯å¢ƒåŠ¡å¿…è®¾ç½®å¯†ç ï¼š"),a("div",{staticClass:"language-ini line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-ini"}},[a("code",[s._v("requirepass yourpassword\nmasterauth yourpassword\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])])])])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("å®¢æˆ·ç«¯è¿æ¥é…ç½®")]),s._v("ï¼ˆSpring Boot ç¤ºä¾‹ï¼‰")]),s._v(" "),a("div",{staticClass:"language-yaml line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("spring")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("redis")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("cluster")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("nodes")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" 172.16.17.100"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7000")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" 172.16.17.100"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7001")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" 172.16.17.101"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7002")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" 172.16.17.101"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7003")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" 172.16.17.102"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7004")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" 172.16.17.102"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7005")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("password")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" yourpassword\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br")])])])]),s._v(" "),a("hr"),s._v(" "),a("h3",{attrs:{id:"ğŸ’-æ€»ç»“"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ’-æ€»ç»“"}},[s._v("#")]),s._v(" ğŸ’ "),a("strong",[s._v("æ€»ç»“")])]),s._v(" "),a("ul",[a("li",[a("strong",[s._v("å•æœºéƒ¨ç½²")]),s._v("ï¼šé€‚åˆå¿«é€ŸéªŒè¯ï¼Œä½¿ç”¨ Docker Compose ä¸€é”®å¯åŠ¨ã€‚")]),s._v(" "),a("li",[a("strong",[s._v("å¤šæœºéƒ¨ç½²")]),s._v("ï¼šç”Ÿäº§é¦–é€‰ï¼Œä¸»ä»è·¨ç‰©ç†æœºï¼Œé€šè¿‡ "),a("code",[s._v("CLUSTER_ANNOUNCE_IP")]),s._v(" æŒ‡å®šå…¬ç½‘ IPã€‚")]),s._v(" "),a("li",[a("strong",[s._v("é«˜å¯ç”¨æ ¸å¿ƒ")]),s._v("ï¼šSlot åˆ†ç‰‡å­˜å‚¨ + ä¸»ä»è‡ªåŠ¨æ•…éšœè½¬ç§»ï¼ˆè¶…æ—¶è§¦å‘é€‰ä¸¾ï¼‰ã€‚")])]),s._v(" "),a("blockquote",[a("p",[s._v("æ‰§è¡Œ "),a("code",[s._v("docker-compose up -d")]),s._v(" åè‹¥é›†ç¾¤åˆ›å»ºå¤±è´¥ï¼Œæ£€æŸ¥èŠ‚ç‚¹æ—¥å¿—ï¼š")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" logs redis-node1  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# æ’æŸ¥ç«¯å£å†²çªæˆ–é…ç½®é”™è¯¯")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])])])}),[],!1,null,null,null);a.default=n.exports}}]);