(window.webpackJsonp=window.webpackJsonp||[]).push([[100],{457:function(v,_,r){"use strict";r.r(_);var t=r(7),o=Object(t.a)({},(function(){var v=this,_=v._self._c;return _("ContentSlotsDistributor",{attrs:{"slot-key":v.$parent.slotKey}},[_("p",[v._v("在 Kafka 的分区副本机制中，"),_("strong",[v._v("副本数（Replication Factor）")]),v._v(" 等于 "),_("strong",[v._v("Leader 副本数量 + Follower 副本数量")]),v._v("。具体关系如下：")]),v._v(" "),_("hr"),v._v(" "),_("h3",{attrs:{id:"📌-一、核心公式"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#📌-一、核心公式"}},[v._v("#")]),v._v(" 📌 "),_("strong",[v._v("一、核心公式")])]),v._v(" "),_("div",{staticClass:"language- line-numbers-mode"},[_("pre",{pre:!0,attrs:{class:"language-text"}},[_("code",[v._v("副本数（Replication Factor） = 1（Leader） + N（Follower）\n")])]),v._v(" "),_("div",{staticClass:"line-numbers-wrapper"},[_("span",{staticClass:"line-number"},[v._v("1")]),_("br")])]),_("ul",[_("li",[_("strong",[v._v("Leader 副本")]),v._v("：每个分区有且仅有 "),_("strong",[v._v("1 个")]),v._v(" Leader，负责处理该分区的所有读写请求。")]),v._v(" "),_("li",[_("strong",[v._v("Follower 副本")]),v._v("：每个分区有 "),_("strong",[v._v("N 个")]),v._v(" Follower（N ≥ 0），仅负责从 Leader 同步数据，不直接服务客户端。")]),v._v(" "),_("li",[_("strong",[v._v("副本总数")]),v._v("：即 "),_("code",[v._v("1 + N")]),v._v("，例如副本数=3 时，包含 "),_("strong",[v._v("1 Leader + 2 Follower")]),v._v("。")])]),v._v(" "),_("hr"),v._v(" "),_("h3",{attrs:{id:"📊-二、角色分工与协作"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#📊-二、角色分工与协作"}},[v._v("#")]),v._v(" 📊 "),_("strong",[v._v("二、角色分工与协作")])]),v._v(" "),_("table",[_("thead",[_("tr",[_("th",[_("strong",[v._v("副本类型")])]),v._v(" "),_("th",[_("strong",[v._v("职责")])]),v._v(" "),_("th",[_("strong",[v._v("是否服务客户端")])]),v._v(" "),_("th",[_("strong",[v._v("数量限制")])])])]),v._v(" "),_("tbody",[_("tr",[_("td",[_("strong",[v._v("Leader")])]),v._v(" "),_("td",[v._v("处理生产者写入和消费者读取请求；管理数据同步到 Follower")]),v._v(" "),_("td",[v._v("✅ 是")]),v._v(" "),_("td",[_("strong",[v._v("固定 1 个")])])]),v._v(" "),_("tr",[_("td",[_("strong",[v._v("Follower")])]),v._v(" "),_("td",[v._v("从 Leader 异步/同步拉取数据；参与 Leader 选举（仅 ISR 中的副本有资格）")]),v._v(" "),_("td",[v._v("❌ 否")]),v._v(" "),_("td",[v._v("可配置（副本数-1）")])])])]),v._v(" "),_("blockquote",[_("p",[v._v("✅ "),_("strong",[v._v("关键点")]),v._v("：")]),v._v(" "),_("ul",[_("li",[v._v("Follower "),_("strong",[v._v("不直接提供读写服务")]),v._v("，仅作为数据冗余备份和故障恢复的候选。")]),v._v(" "),_("li",[v._v("生产者必须将消息发送到 Leader，消费者也必须从 Leader 消费数据。")])])]),v._v(" "),_("hr"),v._v(" "),_("h3",{attrs:{id:"⚙️-三、副本数配置示例"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#⚙️-三、副本数配置示例"}},[v._v("#")]),v._v(" ⚙️ "),_("strong",[v._v("三、副本数配置示例")])]),v._v(" "),_("p",[v._v("假设某 Topic 的分区配置为 "),_("strong",[v._v("副本数=3")]),v._v("，分布到 3 个 Broker 集群：")]),v._v(" "),_("table",[_("thead",[_("tr",[_("th",[_("strong",[v._v("分区")])]),v._v(" "),_("th",[_("strong",[v._v("Leader 所在 Broker")])]),v._v(" "),_("th",[_("strong",[v._v("Follower1 所在 Broker")])]),v._v(" "),_("th",[_("strong",[v._v("Follower2 所在 Broker")])])])]),v._v(" "),_("tbody",[_("tr",[_("td",[v._v("Partition 0")]),v._v(" "),_("td",[v._v("Broker 0")]),v._v(" "),_("td",[v._v("Broker 1")]),v._v(" "),_("td",[v._v("Broker 2")])]),v._v(" "),_("tr",[_("td",[v._v("Partition 1")]),v._v(" "),_("td",[v._v("Broker 1")]),v._v(" "),_("td",[v._v("Broker 2")]),v._v(" "),_("td",[v._v("Broker 0")])])])]),v._v(" "),_("ul",[_("li",[_("strong",[v._v("每个分区的副本总数")]),v._v("："),_("code",[v._v("1 Leader + 2 Follower = 3")]),v._v("。")]),v._v(" "),_("li",[_("strong",[v._v("容错能力")]),v._v("：容忍最多 "),_("strong",[v._v("2 个 Broker 宕机")]),v._v("（N-1 原则，N=副本数）。")])]),v._v(" "),_("hr"),v._v(" "),_("h3",{attrs:{id:"⚠️-四、注意事项"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#⚠️-四、注意事项"}},[v._v("#")]),v._v(" ⚠️ "),_("strong",[v._v("四、注意事项")])]),v._v(" "),_("ol",[_("li",[_("strong",[v._v("副本数上限")]),v._v("：\n"),_("ul",[_("li",[_("strong",[v._v("副本数 ≤ Broker 数量")]),v._v("（例如 3 Broker 时，副本数最大为 3）。")]),v._v(" "),_("li",[v._v("若超过则 Topic 创建失败（如 3 Broker 设置副本数=4 会报错）。")])])]),v._v(" "),_("li",[_("strong",[v._v("Follower 的可用性")]),v._v("：\n"),_("ul",[_("li",[v._v("只有 "),_("strong",[v._v("ISR（In-Sync Replicas）")]),v._v(" 中的 Follower 才具备选举资格。")]),v._v(" "),_("li",[v._v("若 Follower 同步滞后（超过 "),_("code",[v._v("replica.lag.time.max.ms")]),v._v("），会被移出 ISR 集合。")])])]),v._v(" "),_("li",[_("strong",[v._v("生产建议")]),v._v("：\n"),_("ul",[_("li",[_("strong",[v._v("副本数 ≥ 3")]),v._v("：生产环境推荐配置，兼顾容错与成本。")]),v._v(" "),_("li",[_("strong",[v._v("最小同步副本")]),v._v("：设置 "),_("code",[v._v("min.insync.replicas=2")]),v._v("（配合 "),_("code",[v._v("acks=all")]),v._v("），确保消息写入至少 2 个副本（含 Leader）才返回成功。")])])])]),v._v(" "),_("hr"),v._v(" "),_("h3",{attrs:{id:"💎-总结"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#💎-总结"}},[v._v("#")]),v._v(" 💎 "),_("strong",[v._v("总结")])]),v._v(" "),_("blockquote",[_("p",[_("strong",[v._v("副本数 = 1（Leader） + N（Follower）")])]),v._v(" "),_("ul",[_("li",[_("strong",[v._v("Leader")]),v._v("：唯一读写入口，承担服务压力；")]),v._v(" "),_("li",[_("strong",[v._v("Follower")]),v._v("：纯备份角色，通过 ISR 机制保障故障切换的可靠性。")])]),v._v(" "),_("p",[v._v("合理配置副本数（如 3 副本）是 Kafka 实现"),_("strong",[v._v("高可用、数据持久化")]),v._v("的核心设计。")])])])}),[],!1,null,null,null);_.default=o.exports}}]);