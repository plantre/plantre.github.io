(window.webpackJsonp=window.webpackJsonp||[]).push([[202],{559:function(a,s,t){"use strict";t.r(s);var r=t(7),e=Object(r.a)({},(function(){var a=this,s=a._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("h1",{attrs:{id:"å¯ç”¨è·¯ç”±è½¬å‘"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#å¯ç”¨è·¯ç”±è½¬å‘"}},[a._v("#")]),a._v(" å¯ç”¨è·¯ç”±è½¬å‘")]),a._v(" "),s("p",[a._v("echo 1 > /proc/sys/net/ipv4/ip_forward")]),a._v(" "),s("h1",{attrs:{id:"dnat-æŠŠç›®æ ‡ä¸º-b-çš„è¯·æ±‚è½¬å‘ç»™-c"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#dnat-æŠŠç›®æ ‡ä¸º-b-çš„è¯·æ±‚è½¬å‘ç»™-c"}},[a._v("#")]),a._v(" DNAT æŠŠç›®æ ‡ä¸º B çš„è¯·æ±‚è½¬å‘ç»™ C")]),a._v(" "),s("p",[a._v("iptables -t nat -A PREROUTING -d 1.2.3.4 -j DNAT --to-destination 5.6.7.8")]),a._v(" "),s("h1",{attrs:{id:"snat-ä¿®æ”¹æºåœ°å€ä¸º-a-è‡ªå·±-é¿å…-c-æ— æ³•è¿”å›"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#snat-ä¿®æ”¹æºåœ°å€ä¸º-a-è‡ªå·±-é¿å…-c-æ— æ³•è¿”å›"}},[a._v("#")]),a._v(" SNAT ä¿®æ”¹æºåœ°å€ä¸º A è‡ªå·±ï¼Œé¿å… C æ— æ³•è¿”å›")]),a._v(" "),s("p",[a._v("iptables -t nat -A POSTROUTING -j MASQUERADEï¼Œ ä»¥å…·ä½“çš„ipæ•°æ®åŒ…è¯´æ˜")]),a._v(" "),s("p",[a._v("å¥½çš„ï¼Œæˆ‘ä»¬é€šè¿‡ä¸€ä¸ªå…·ä½“çš„ "),s("strong",[a._v("IP æ•°æ®åŒ…æµç¨‹ç¤ºä¾‹")]),a._v("ï¼Œè¯¦ç»†è¯´æ˜ä½ é…ç½®çš„ "),s("code",[a._v("iptables")]),a._v(" è§„åˆ™å¦‚ä½•è®©å®¢æˆ·ç«¯ A å°†åŸæœ¬å‘ç»™æœåŠ¡å™¨ B çš„æ•°æ®ï¼Œ"),s("strong",[a._v("é€æ˜åœ°è½¬å‘åˆ°æœåŠ¡å™¨ C å¹¶æ”¶åˆ°å“åº”")]),a._v("ã€‚")]),a._v(" "),s("hr"),a._v(" "),s("h2",{attrs:{id:"ğŸ“¦-åœºæ™¯è®¾å®š"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ“¦-åœºæ™¯è®¾å®š"}},[a._v("#")]),a._v(" ğŸ“¦ åœºæ™¯è®¾å®šï¼š")]),a._v(" "),s("ul",[s("li",[a._v("ä½ ç°åœ¨é…ç½®åœ¨ä¸»æœº A ä¸Šä½œä¸ºç½‘å…³æˆ–è·³æ¿æœºã€‚")]),a._v(" "),s("li",[a._v("æŸå°å®¢æˆ·ç«¯ï¼ˆä¾‹å¦‚ A æœ¬äººæˆ– A åé¢çš„æœºå™¨ï¼‰åŸæœ¬è¦è®¿é—®ï¼š")])]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("ç›®çš„ IPï¼ˆBï¼‰ï¼š1.2.3.4 ï¼ˆå·²å®•æœºï¼‰\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("ul",[s("li",[a._v("ä½ å¸Œæœ›å®ƒå®é™…ä¸Šè®¿é—®ï¼š")])]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("çœŸå®å¤„ç†æœåŠ¡å™¨ C çš„ IPï¼š5.6.7.8\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("hr"),a._v(" "),s("h2",{attrs:{id:"âœ…-é…ç½®å›é¡¾-iptables-è½¬å‘è§„åˆ™"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#âœ…-é…ç½®å›é¡¾-iptables-è½¬å‘è§„åˆ™"}},[a._v("#")]),a._v(" âœ… é…ç½®å›é¡¾ï¼ˆiptables è½¬å‘è§„åˆ™ï¼‰ï¼š")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# å¯ç”¨ IP è½¬å‘")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("echo")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" /proc/sys/net/ipv4/ip_forward\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# æŠŠå‘å¾€ 1.2.3.4 çš„æ•°æ®åŒ…è½¬å‘ç»™ 5.6.7.8")]),a._v("\niptables "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-t")]),a._v(" nat "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-A")]),a._v(" PREROUTING "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-d")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1.2")]),a._v(".3.4 "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-j")]),a._v(" DNAT --to-destination "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("5.6")]),a._v(".7.8\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# æŠŠåŸå§‹æº IP ä¼ªè£…æˆ A çš„ IPï¼Œä¿è¯è¿”å›èƒ½æˆåŠŸ")]),a._v("\niptables "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-t")]),a._v(" nat "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-A")]),a._v(" POSTROUTING "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-j")]),a._v(" MASQUERADE\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br")])]),s("hr"),a._v(" "),s("h2",{attrs:{id:"ğŸ”„-æ•°æ®åŒ…æµåŠ¨è¿‡ç¨‹è¯¦è§£-æŒ‰é¡ºåº"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ”„-æ•°æ®åŒ…æµåŠ¨è¿‡ç¨‹è¯¦è§£-æŒ‰é¡ºåº"}},[a._v("#")]),a._v(" ğŸ”„ æ•°æ®åŒ…æµåŠ¨è¿‡ç¨‹è¯¦è§£ï¼ˆæŒ‰é¡ºåºï¼‰ï¼š")]),a._v(" "),s("table",[s("thead",[s("tr",[s("th",[a._v("æ­¥éª¤")]),a._v(" "),s("th",[a._v("åŸå§‹æ•°æ®åŒ…å†…å®¹")]),a._v(" "),s("th",[a._v("æè¿°")])])]),a._v(" "),s("tbody",[s("tr",[s("td",[a._v("1ï¸âƒ£ å®¢æˆ·ç«¯å‘å‡ºè¯·æ±‚")]),a._v(" "),s("td",[a._v("æº IPï¼š192.168.0.100"),s("br"),a._v("ç›®æ ‡ IPï¼š1.2.3.4")]),a._v(" "),s("td",[a._v("å®¢æˆ·ç«¯è®¤ä¸ºå®ƒåœ¨è®¿é—®æœåŠ¡å™¨ B")])]),a._v(" "),s("tr",[s("td",[a._v("2ï¸âƒ£ A æœºå™¨æ‹¦æˆªåˆ°æ•°æ®åŒ…ï¼ˆPREROUTINGï¼‰")]),a._v(" "),s("td",[a._v("- æ£€æµ‹ç›®æ ‡ IP ä¸º 1.2.3.4"),s("br"),a._v("- è§¦å‘ "),s("code",[a._v("DNAT")]),a._v(" è§„åˆ™"),s("br"),a._v("- ä¿®æ”¹ç›®æ ‡ IP ä¸º 5.6.7.8")]),a._v(" "),s("td",[a._v("æ•°æ®åŒ…ç°åœ¨å˜ä¸ºï¼š"),s("br"),a._v("æº IPï¼š192.168.0.100"),s("br"),a._v("ç›®æ ‡ IPï¼š"),s("strong",[a._v("5.6.7.8")])])]),a._v(" "),s("tr",[s("td",[a._v("3ï¸âƒ£ æ•°æ®åŒ…è¢«è½¬å‘åˆ°æœåŠ¡å™¨ C")]),a._v(" "),s("td",[a._v("æº IPï¼š192.168.0.100"),s("br"),a._v("ç›®æ ‡ IPï¼š5.6.7.8")]),a._v(" "),s("td",[a._v("C æ”¶åˆ°è¯·æ±‚ï¼Œä»¥ä¸ºæ˜¯å®¢æˆ·ç«¯ç›´æ¥è®¿é—®")])]),a._v(" "),s("tr",[s("td",[a._v("4ï¸âƒ£ C å›å¤å“åº”åŒ…")]),a._v(" "),s("td",[a._v("æº IPï¼š5.6.7.8"),s("br"),a._v("ç›®æ ‡ IPï¼š192.168.0.100")]),a._v(" "),s("td",[a._v("C å‘å›å“åº”ï¼Œå›åˆ°ä¸»æœº A")])]),a._v(" "),s("tr",[s("td",[a._v("5ï¸âƒ£ A æœºå™¨åŒ¹é… conntrack è¿æ¥è·Ÿè¸ªï¼ˆPOSTROUTINGï¼‰"),s("br"),a._v("è§¦å‘ "),s("code",[a._v("MASQUERADE")])]),a._v(" "),s("td",[a._v("- A ä¿®æ”¹å“åº”æ•°æ®åŒ…æºåœ°å€"),s("br"),a._v("- æŠŠæº IP å˜æˆ 1.2.3.4"),s("br"),a._v("ï¼ˆæˆ– A çš„ IPï¼‰")]),a._v(" "),s("td",[a._v("å®¢æˆ·ç«¯æ”¶åˆ°å“åº”æ—¶ï¼Œçœ‹ä¸å‡ºæ˜¯ C å›å¤çš„")])]),a._v(" "),s("tr",[s("td",[a._v("6ï¸âƒ£ å®¢æˆ·ç«¯æ”¶åˆ°å“åº”")]),a._v(" "),s("td",[a._v("æº IPï¼š1.2.3.4"),s("br"),a._v("ç›®æ ‡ IPï¼š192.168.0.100")]),a._v(" "),s("td",[a._v("å®¢æˆ·ç«¯ä»¥ä¸ºè‡ªå·±ä¸æœåŠ¡å™¨ B æ­£å¸¸é€šä¿¡äº†")])])])]),a._v(" "),s("hr"),a._v(" "),s("h2",{attrs:{id:"âœ…-ç»“æœ"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#âœ…-ç»“æœ"}},[a._v("#")]),a._v(" âœ… ç»“æœ")]),a._v(" "),s("p",[a._v("å®¢æˆ·ç«¯ä»¥ä¸ºå®ƒä¸ "),s("code",[a._v("1.2.3.4")]),a._v("ï¼ˆBï¼‰å»ºç«‹äº†é€šä¿¡ï¼Œä½†å…¶å®ï¼š")]),a._v(" "),s("ul",[s("li",[a._v("æ‰€æœ‰è¯·æ±‚éƒ½è¢« A ä¸»æœºå·å·è½¬å‘åˆ°äº† Cï¼ˆ5.6.7.8ï¼‰")]),a._v(" "),s("li",[a._v("æ‰€æœ‰å“åº”ä¹Ÿç”± A ä¿®æ”¹è¿”å›è·¯å¾„ï¼Œä¼ªè£…æˆ B")])]),a._v(" "),s("hr"),a._v(" "),s("h2",{attrs:{id:"ğŸ“Œ-å…³é”®ç‚¹è§£é‡Š"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ“Œ-å…³é”®ç‚¹è§£é‡Š"}},[a._v("#")]),a._v(" ğŸ“Œ å…³é”®ç‚¹è§£é‡Šï¼š")]),a._v(" "),s("ul",[s("li",[s("strong",[a._v("DNATï¼ˆç›®çš„åœ°å€è½¬æ¢ï¼‰")]),a._v("ï¼šä¿®æ”¹ç›®æ ‡åœ°å€ï¼ŒæŠŠåŒ…å‘ç»™æ–°çš„æœåŠ¡ã€‚")]),a._v(" "),s("li",[s("strong",[a._v("SNAT/MASQUERADEï¼ˆæºåœ°å€è½¬æ¢ï¼‰")]),a._v("ï¼šè®©è¿”å›è·¯å¾„æ­£ç¡®ï¼ŒC ä¸ç›´æ¥è¿”å›ç»™å®¢æˆ·ç«¯ï¼Œè€Œæ˜¯é€šè¿‡ Aã€‚")]),a._v(" "),s("li",[s("strong",[a._v("ip_forward=1")]),a._v("ï¼šLinux å…è®¸è½¬å‘æ•°æ®åŒ…ï¼ŒA ç›¸å½“äºä¸€ä¸ªé€æ˜è·¯ç”±å™¨ã€‚")])]),a._v(" "),s("hr"),a._v(" "),s("h2",{attrs:{id:"ğŸ’¡-ä¸¾ä¾‹å°åŒ…-tcp-å±‚"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ’¡-ä¸¾ä¾‹å°åŒ…-tcp-å±‚"}},[a._v("#")]),a._v(" ğŸ’¡ ä¸¾ä¾‹å°åŒ…ï¼ˆTCP å±‚ï¼‰")]),a._v(" "),s("p",[a._v("è¯·æ±‚åŒ…ï¼š")]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("Client -> Aï¼ˆPREROUTINGï¼‰: SYN packet\nSrc: 192.168.0.100\nDst: 1.2.3.4 â†’ DNAT â†’ 5.6.7.8\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br")])]),s("p",[a._v("C æ”¶åˆ°åŒ…åè¿”å›ï¼š")]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("C â†’ Aï¼ˆPOSTROUTINGï¼‰â†’ Client\nSrc: 5.6.7.8 â†’ MASQUERADE â†’ 1.2.3.4\nDst: 192.168.0.100\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br")])]),s("hr"),a._v(" "),s("p",[a._v("å¦‚ä½ å¸Œæœ›æˆ‘æä¾›ä¸€ä¸ª "),s("strong",[a._v("å®Œæ•´å¯æ‰§è¡Œçš„ Shell è„šæœ¬ç¤ºä¾‹ï¼ˆå«é˜²ç«å¢™æ¸…é™¤ã€è§„åˆ™è®¾ç½®ç­‰ï¼‰")]),a._v("ï¼Œæˆ‘ä¹Ÿå¯ä»¥è¡¥å……ã€‚éœ€è¦å—ï¼Ÿ")])])}),[],!1,null,null,null);s.default=e.exports}}]);